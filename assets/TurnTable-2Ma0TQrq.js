import{C as se}from"./index-DHTZ1wcc.js";import{_ as Ke,C as Ee,r as v,j as Ce,w as Oe,e as ze,c as j,a as f,k as u,q as le,l as w,p as F,S as N,v as S,o as L,u as V,D as Se,y as oe,z as Le,A as Ae,b as W,B as G}from"./index-DbvDPFsM.js";const J=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function X(e,t,l,n){e.addEventListener?e.addEventListener(t,l,n):e.attachEvent&&e.attachEvent("on".concat(t),l)}function I(e,t,l,n){e.removeEventListener?e.removeEventListener(t,l,n):e.detachEvent&&e.detachEvent("on".concat(t),l)}function re(e,t){const l=t.slice(0,t.length-1);for(let n=0;n<l.length;n++)l[n]=e[l[n].toLowerCase()];return l}function ue(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");const t=e.split(",");let l=t.lastIndexOf("");for(;l>=0;)t[l-1]+=",",t.splice(l,1),l=t.lastIndexOf("");return t}function Me(e,t){const l=e.length>=t.length?e:t,n=e.length>=t.length?t:e;let s=!0;for(let a=0;a<l.length;a++)n.indexOf(l[a])===-1&&(s=!1);return s}const B={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":J?173:189,"=":J?61:187,";":J?59:186,"'":222,"[":219,"]":221,"\\":220},z={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},Q={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},_={16:!1,18:!1,17:!1,91:!1},d={};for(let e=1;e<20;e++)B["f".concat(e)]=111+e;let c=[],T=null,ce="all";const A=new Map,$=e=>B[e.toLowerCase()]||z[e.toLowerCase()]||e.toUpperCase().charCodeAt(0),Ve=e=>Object.keys(B).find(t=>B[t]===e),Pe=e=>Object.keys(z).find(t=>z[t]===e);function fe(e){ce=e||"all"}function U(){return ce||"all"}function je(){return c.slice(0)}function Ie(){return c.map(e=>Ve(e)||Pe(e)||String.fromCharCode(e))}function Te(){const e=[];return Object.keys(d).forEach(t=>{d[t].forEach(l=>{let{key:n,scope:s,mods:a,shortcut:r}=l;e.push({scope:s,shortcut:r,mods:a,keys:n.split("+").map(o=>$(o))})})}),e}function Be(e){const t=e.target||e.srcElement,{tagName:l}=t;let n=!0;const s=l==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(t.type);return(t.isContentEditable||(s||l==="TEXTAREA"||l==="SELECT")&&!t.readOnly)&&(n=!1),n}function Ue(e){return typeof e=="string"&&(e=$(e)),c.indexOf(e)!==-1}function $e(e,t){let l,n;e||(e=U());for(const s in d)if(Object.prototype.hasOwnProperty.call(d,s))for(l=d[s],n=0;n<l.length;)l[n].scope===e?l.splice(n,1).forEach(r=>{let{element:o}=r;return Z(o)}):n++;U()===e&&fe(t||"all")}function Ne(e){let t=e.keyCode||e.which||e.charCode;const l=c.indexOf(t);if(l>=0&&c.splice(l,1),e.key&&e.key.toLowerCase()==="meta"&&c.splice(0,c.length),(t===93||t===224)&&(t=91),t in _){_[t]=!1;for(const n in z)z[n]===t&&(O[n]=!1)}}function de(e){if(typeof e>"u")Object.keys(d).forEach(s=>{Array.isArray(d[s])&&d[s].forEach(a=>R(a)),delete d[s]}),Z(null);else if(Array.isArray(e))e.forEach(s=>{s.key&&R(s)});else if(typeof e=="object")e.key&&R(e);else if(typeof e=="string"){for(var t=arguments.length,l=new Array(t>1?t-1:0),n=1;n<t;n++)l[n-1]=arguments[n];let[s,a]=l;typeof s=="function"&&(a=s,s=""),R({key:e,scope:s,method:a,splitKey:"+"})}}const R=e=>{let{key:t,scope:l,method:n,splitKey:s="+"}=e;ue(t).forEach(r=>{const o=r.split(s),y=o.length,b=o[y-1],E=b==="*"?"*":$(b);if(!d[E])return;l||(l=U());const k=y>1?re(z,o):[],x=[];d[E]=d[E].filter(g=>{const m=(n?g.method===n:!0)&&g.scope===l&&Me(g.mods,k);return m&&x.push(g.element),!m}),x.forEach(g=>Z(g))})};function ie(e,t,l,n){if(t.element!==n)return;let s;if(t.scope===l||t.scope==="all"){s=t.mods.length>0;for(const a in _)Object.prototype.hasOwnProperty.call(_,a)&&(!_[a]&&t.mods.indexOf(+a)>-1||_[a]&&t.mods.indexOf(+a)===-1)&&(s=!1);(t.mods.length===0&&!_[16]&&!_[18]&&!_[17]&&!_[91]||s||t.shortcut==="*")&&(t.keys=[],t.keys=t.keys.concat(c),t.method(e,t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function ae(e,t){const l=d["*"];let n=e.keyCode||e.which||e.charCode;if(!O.filter.call(this,e))return;if((n===93||n===224)&&(n=91),c.indexOf(n)===-1&&n!==229&&c.push(n),["ctrlKey","altKey","shiftKey","metaKey"].forEach(o=>{const y=Q[o];e[o]&&c.indexOf(y)===-1?c.push(y):!e[o]&&c.indexOf(y)>-1?c.splice(c.indexOf(y),1):o==="metaKey"&&e[o]&&c.length===3&&(e.ctrlKey||e.shiftKey||e.altKey||(c=c.slice(c.indexOf(y))))}),n in _){_[n]=!0;for(const o in z)z[o]===n&&(O[o]=!0);if(!l)return}for(const o in _)Object.prototype.hasOwnProperty.call(_,o)&&(_[o]=e[Q[o]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(c.indexOf(17)===-1&&c.push(17),c.indexOf(18)===-1&&c.push(18),_[17]=!0,_[18]=!0);const s=U();if(l)for(let o=0;o<l.length;o++)l[o].scope===s&&(e.type==="keydown"&&l[o].keydown||e.type==="keyup"&&l[o].keyup)&&ie(e,l[o],s,t);if(!(n in d))return;const a=d[n],r=a.length;for(let o=0;o<r;o++)if((e.type==="keydown"&&a[o].keydown||e.type==="keyup"&&a[o].keyup)&&a[o].key){const y=a[o],{splitKey:b}=y,E=y.key.split(b),k=[];for(let x=0;x<E.length;x++)k.push($(E[x]));k.sort().join("")===c.sort().join("")&&ie(e,y,s,t)}}function O(e,t,l){c=[];const n=ue(e);let s=[],a="all",r=document,o=0,y=!1,b=!0,E="+",k=!1,x=!1;for(l===void 0&&typeof t=="function"&&(l=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(a=t.scope),t.element&&(r=t.element),t.keyup&&(y=t.keyup),t.keydown!==void 0&&(b=t.keydown),t.capture!==void 0&&(k=t.capture),typeof t.splitKey=="string"&&(E=t.splitKey),t.single===!0&&(x=!0)),typeof t=="string"&&(a=t),x&&de(e,a);o<n.length;o++)e=n[o].split(E),s=[],e.length>1&&(s=re(z,e)),e=e[e.length-1],e=e==="*"?"*":$(e),e in d||(d[e]=[]),d[e].push({keyup:y,keydown:b,scope:a,mods:s,shortcut:n[o],method:l,key:n[o],splitKey:E,element:r});if(typeof r<"u"&&window){if(!A.has(r)){const g=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return ae(m,r)},M=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;ae(m,r),Ne(m)};A.set(r,{keydownListener:g,keyupListenr:M,capture:k}),X(r,"keydown",g,k),X(r,"keyup",M,k)}if(!T){const g=()=>{c=[]};T={listener:g,capture:k},X(window,"focus",g,k)}}}function Re(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(d).forEach(l=>{d[l].filter(s=>s.scope===t&&s.shortcut===e).forEach(s=>{s&&s.method&&s.method()})})}function Z(e){const t=Object.values(d).flat();if(t.findIndex(n=>{let{element:s}=n;return s===e})<0){const{keydownListener:n,keyupListenr:s,capture:a}=A.get(e)||{};n&&s&&(I(e,"keyup",s,a),I(e,"keydown",n,a),A.delete(e))}if((t.length<=0||A.size<=0)&&(Object.keys(A).forEach(s=>{const{keydownListener:a,keyupListenr:r,capture:o}=A.get(s)||{};a&&r&&(I(s,"keyup",r,o),I(s,"keydown",a,o),A.delete(s))}),A.clear(),Object.keys(d).forEach(s=>delete d[s]),T)){const{listener:s,capture:a}=T;I(window,"focus",s,a),T=null}}const Y={getPressedKeyString:Ie,setScope:fe,getScope:U,deleteScope:$e,getPressedKeyCodes:je,getAllKeyCodes:Te,isPressed:Ue,filter:Be,trigger:Re,unbind:de,keyMap:B,modifier:z,modifierMap:Q};for(const e in Y)Object.prototype.hasOwnProperty.call(Y,e)&&(O[e]=Y[e]);if(typeof window<"u"){const e=window.hotkeys;O.noConflict=t=>(t&&window.hotkeys===O&&(window.hotkeys=e),O),window.hotkeys=O}const De={class:"app-content flex-center"},He={class:"turn-table d-flex flex-column align-items-center"},qe={class:"text"},Fe={key:0},We={key:1},Ge={key:2},Je={key:0,class:"float-card"},Xe={class:"d-flex flex-column"},Ye={class:"d-flex align-items-center mt-2"},Qe={class:"d-flex align-items-center mt-2"},Ze={class:"d-flex align-items-center mt-2"},et={class:"mt-2"},tt={class:"d-flex flex-column"},nt={class:"d-flex"},st={class:"mt-2"},lt={class:"ms-auto mt-2"},ot={class:"mt-2"},it={key:1,class:"float-card"},at=!1,rt={__name:"TurnTable",setup(e){Ee(()=>{O.unbind("space")});function t(p,i){const h=Math.ceil(p),K=Math.floor(i);return Math.floor(Math.random()*(K-h+1)+h)}const l=v([{radius:"30%",background:"#8a9bf3",pointer:!0,fonts:[{text:"开始",top:"-15px",fontSize:"30px"}]}]);localStorage.getItem("use_music");let n=localStorage.getItem("block_size");n==null||n===NaN?n=500:n=parseInt(n)<200?200:parseInt(n);let s=localStorage.getItem("prizes_input");(typeof s!="string"||s==="")&&(s=`A
B
C`),v("未使用预设模式");const a=v(!1),r=v(n),o=v(s),y=v(s),b=v(at),E=v("");v("");const k=v(null),x=v(!1),g=v(!1),M=v(null),m=v([]),P=v(!1),pe=v([{padding:"13px",background:"#617df2"}]),me=Ce(()=>{const p=["#e9e8fe","#b8c5f2"],i=[];for(let h=0;h<m.value.length;h++)i.push({fonts:[{text:m.value[h].name,top:"15%",fontSize:"30px",fontColor:m.value[h].lottery?"#e45656":"#000"}],background:(h+1)%2===0?p[0]:p[1]});return i}),ee=()=>{const p=o.value;try{const i=p.split(`
`);m.value=[],i.forEach(h=>{let K=!1;h.substring(0,1)==="!"&&(K=!0,h=h.substring(1)),m.value.push({name:h,lottery:K})})}catch{m.value=[]}localStorage.setItem("prizes_input",p)};Oe(r,p=>{localStorage.setItem("block_size",p)});const te=()=>{k.value.stop(t(0,m.value.length-1)),x.value=!1,g.value=!0},ye=()=>{k.value.play(),x.value=!0,M.value=setTimeout(()=>{te()},3*1e3)},ge=p=>{const i=p.fonts[0].text;m.value=m.value.filter((h,K)=>h.name!==i),g.value=!1,console.log(m.value)},D=()=>{g.value||m.value.length<=0||(M.value!==null&&(clearTimeout(M.value),M.value=null),x.value?te():ye())};O("space",function(p,i){D()});const he=async()=>{const{value:p}=await N.fire({title:"输入解稿密码",input:"password",inputLabel:"Password",inputPlaceholder:"Enter your password",inputAttributes:{maxlength:"20",autocapitalize:"off",autocorrect:"off"}});p&&(E.value=se.SHA256(p).toString(),N.fire({title:"设置解稿密码成功！",icon:"success"}),b.value=!0)},_e=async()=>{const{value:p}=await N.fire({title:"输入解稿密码",input:"password",inputLabel:"Password",inputPlaceholder:"Enter your password",inputAttributes:{maxlength:"20",autocapitalize:"off",autocorrect:"off"}});p&&(se.SHA256(p).toString()===E.value?(b.value=!1,P.value=!0):N.fire({title:"解稿失败，密码错误！",icon:"warning"}))},ve=()=>{b.value?(P.value=!1,_e()):P.value=!P.value};return ze(()=>{ee()}),(p,i)=>{const h=S("LuckyWheel"),K=S("el-icon"),H=S("el-button"),ne=S("el-switch"),q=S("el-tooltip"),we=S("el-slider"),ke=S("el-input"),be=S("el-popconfirm"),xe=S("el-result");return L(),j("div",De,[f("div",He,[u(h,{ref_key:"myLucky",ref:k,width:`${r.value}px`,height:`${r.value}px`,prizes:me.value,blocks:pe.value,buttons:l.value,onEnd:ge,onClick:D},null,8,["width","height","prizes","blocks","buttons"]),f("div",{class:le(["notice flex-center",{animation:!g.value}]),onClick:i[0]||(i[0]=C=>D())},[f("span",qe,[g.value?(L(),j("span",Fe,[u(K,{size:"50",style:{transform:"translateY(5px)"}},{default:w(()=>[u(V(Se))]),_:1})])):x.value?(L(),j("span",We,"Stop")):(L(),j("span",Ge,"Start"))])],2)]),f("div",{class:le(["float-card-content",`${P.value&&!b.value?"open":""} `])},[f("div",{class:"close cursor-pointer",onClick:ve},[b.value?(L(),F(K,{key:0,class:"text-danger"},{default:w(()=>[u(V(oe))]),_:1})):P.value?(L(),F(K,{key:1},{default:w(()=>[u(V(Le))]),_:1})):(L(),F(K,{key:2},{default:w(()=>[u(V(Ae))]),_:1}))]),b.value?(L(),j("div",it,[i[16]||(i[16]=f("h4",null,"设置",-1)),i[17]||(i[17]=f("hr",{class:"my-2"},null,-1)),u(xe,{class:"mt-4",title:"已定稿","sub-title":"禁止修改"},{icon:w(()=>[u(K,{size:"50",class:"text-danger"},{default:w(()=>[u(V(oe))]),_:1})]),_:1})])):(L(),j("div",Je,[i[14]||(i[14]=f("h4",null,"设置",-1)),i[15]||(i[15]=f("hr",{class:"my-2"},null,-1)),f("div",Xe,[u(H,{type:"danger",class:"mt-2",onClick:i[1]||(i[1]=C=>p.flushed())},{default:w(()=>i[7]||(i[7]=[W("重置")])),_:1}),f("div",null,[f("div",Ye,[i[8]||(i[8]=f("h6",{class:"text-nowrap mb-0"},"启用中奖音效：",-1)),u(ne,{modelValue:a.value,"onUpdate:modelValue":i[2]||(i[2]=C=>a.value=C)},null,8,["modelValue"]),u(q,{content:"好运来",placement:"top"},{default:w(()=>[u(K,{class:"ms-2",size:"20"},{default:w(()=>[u(V(G))]),_:1})]),_:1})]),f("div",Qe,[i[9]||(i[9]=f("h6",{class:"text-nowrap mb-0"},"抽中后隐藏：",-1)),u(ne,{modelValue:y.value,"onUpdate:modelValue":i[3]||(i[3]=C=>y.value=C)},null,8,["modelValue"]),u(q,{content:"包括未中奖的“奖”品",placement:"top"},{default:w(()=>[u(K,{class:"ms-2",size:"20"},{default:w(()=>[u(V(G))]),_:1})]),_:1})]),f("div",Ze,[i[10]||(i[10]=f("h6",{class:"text-nowrap me-2"},"转盘大小：",-1)),u(we,{modelValue:r.value,"onUpdate:modelValue":i[4]||(i[4]=C=>r.value=C),step:10,max:1e3,min:100},null,8,["modelValue"])]),f("div",et,[f("div",null,[f("div",tt,[f("div",nt,[i[11]||(i[11]=f("h6",{class:"text-nowrap"},"奖品列表：",-1)),u(q,{content:"奖品列表，回车分隔奖品，最前方加“!”表示中奖",placement:"top"},{default:w(()=>[u(K,{size:"20"},{default:w(()=>[u(V(G))]),_:1})]),_:1})]),f("div",st,[u(ke,{type:"textarea",modelValue:o.value,"onUpdate:modelValue":i[5]||(i[5]=C=>o.value=C)},null,8,["modelValue"])]),f("div",lt,[u(H,{onClick:i[6]||(i[6]=C=>ee())},{default:w(()=>i[12]||(i[12]=[W("更新")])),_:1})])])])]),f("div",ot,[u(be,{title:"确认定稿？",onConfirm:he},{reference:w(()=>[u(H,{class:"w-100"},{default:w(()=>i[13]||(i[13]=[W("定稿")])),_:1})]),_:1})])])])]))],2)])}}},ft=Ke(rt,[["__scopeId","data-v-c96f1b36"]]);export{ft as default};
